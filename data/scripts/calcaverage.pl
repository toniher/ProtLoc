#!/usr/bin/perl

$input=$ARGV[0];
print "$input\n";
open (IN, "<$input") || die "Cannot open input";

while (<IN>) {

		$count++;
		
		($ar[0])=$_=~/^.*\|(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[1])=$_=~/^.*\|.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[2])=$_=~/^.*\|.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[3])=$_=~/^.*\|.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[4])=$_=~/^.*\|.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[5])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[6])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[7])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[8])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[9])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[10])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[11])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[12])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[13])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[14])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*.*\*/;
		($ar[15])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*.*\*/;
		($ar[16])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*.*\*/;
		($ar[17])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*.*\*/;
		($ar[18])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*.*\*/;
		($ar[19])=$_=~/^.*\|.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*.*\*(.*)\*/;
		

		for ($j=0; $j<20; $j++) {

			$mun[$j]+= $ar[$j];
		
			for ($k=0; $k<20; $k++) {
			
				$mdos[$j][$k]+=$ar[$j]*$ar[$k];

			}
		}
	
	
	undef @ar;
}

close (INPUT);

for ($i=0; $i<20; $i++) {
	
	$freqm[$i]=$mun[$i]/$count;

	for ($l=0; $l<20; $l++) {
		
		$freqs[$i][$l]=$mdos[$i][$l]/$count;

	}

}

open (FILEAVG, ">avg-$input") || die "Cannot write down averages";

for ($m=0; $m<20; $m++) {

	print FILEAVG "\[\t$freqm[$m]\t\]\n";
	
}

close (FILEAVG);

open (FILEVAR, ">var-$input") || die "Cannot write down variances";

for ($n=0; $n<20; $n++) {

	print FILEVAR "\[\t";

	for ($p=0; $p<20; $p++) {

		print FILEVAR "$freqs[$n][$p]\t";

	}

	print FILEVAR "\]\n";

}




